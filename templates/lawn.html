{% extends "base.html" %}

{% block title %}나의 잔디밭 - Lawn Todo{% endblock %}

{% block styles %}
<style>
    .lawn-container {
        margin-top: 2rem;
        padding: 1.5rem;
        border: 1px solid #d0d7de;
        border-radius: 6px;
        max-width: fit-content;
        margin-left: auto;
        margin-right: auto;
    }
    .lawn-header {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 1rem;
    }
    .graph-container {
        display: flex;
        gap: 8px;
    }
    .weekdays {
        display: grid;
        grid-template-rows: repeat(7, 1fr);
        gap: 4px;
        font-size: 0.75rem;
        color: #57606a;
        padding-top: 20px; /* Month labels offset */
        text-align: left;
    }
    .weekdays > div {
        height: 12px;
        width: 30px;
        line-height: 12px;
    }
    .scrollable-graph {
        overflow-x: auto;
        padding-bottom: 10px;
    }
    .graph {
        display: flex;
        flex-direction: column;
        gap: 4px;
    }
    .months {
        display: flex;
        font-size: 0.75rem;
        color: #57606a;
        height: 16px;
    }
    .month {
        width: calc(16px * 4.5); /* Approx 4.5 weeks per month */
        text-align: left;
    }
    .days {
        display: flex;
        flex-direction: column;
        flex-wrap: wrap;
        gap: 4px;
        height: calc(7 * (12px + 4px)); /* 7 days * (cell height + gap) */
    }
    .week {
        display: grid;
        grid-template-rows: repeat(7, 1fr);
        gap: 4px;
    }
    .day-cell {
        width: 12px;
        height: 12px;
        background-color: #ebedf0;
        border-radius: 2px;
        position: relative;
    }
    .day-cell[data-level="1"] { background-color: #9be9a8; }
    .day-cell[data-level="2"] { background-color: #40c463; }
    .day-cell[data-level="3"] { background-color: #30a14e; }
    .day-cell[data-level="4"] { background-color: #216e39; }
    .day-cell .tooltip {
        visibility: hidden;
        width: max-content;
        background-color: #333;
        color: #fff;
        text-align: center;
        border-radius: 4px;
        padding: 5px 8px;
        position: absolute;
        z-index: 1;
        bottom: 125%;
        left: 50%;
        transform: translateX(-50%);
        opacity: 0;
        transition: opacity 0.2s;
        font-size: 0.75rem;
        pointer-events: none;
    }
    .day-cell:hover .tooltip {
        visibility: visible;
        opacity: 1;
    }
</style>
{% endblock %}

{% block content %}
<div class="lawn-container">
    <h2 class="lawn-header">지난 1년간의 활동</h2>
    <div class="graph-container">
        <div class="weekdays">
            <div></div>
            <div>월</div>
            <div></div>
            <div>수</div>
            <div></div>
            <div>금</div>
            <div></div>
        </div>
        <div class="scrollable-graph">
            <div class="graph">
                <div class="months">
                    {% for week in weeks %}
                        {% if week[0].month_label %}
                            <div class="month" style="min-width: calc(16px * {{ loop.length - loop.index0 }});">{{ week[0].month_label }}</div>
                        {% endif %}
                    {% endfor %}
                </div>
                <div class="days">
                    {% for week in weeks %}
                        <div class="week">
                            {% for day in week %}
                                <div class="day-cell" 
                                     data-level="{{ day.level }}"
                                     title="{{ day.date.strftime('%Y-%m-%d') }}: {{ day.count }}개의 할 일 완료">
                                     <span class="tooltip">{{ day.date.strftime('%Y-%m-%d') }}<br>{{ day.count }}개의 할 일 완료</span>
                                </div>
                            {% endfor %}
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
