{% macro render_lawn(weeks, month_weeks, today, size='large') %}
<style>
    .graph-container {
        border: 1px solid #e1e4e8;
        border-radius: 6px;
        padding: 16px;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
        overflow-x: auto;
    }
    .graph-container.size-small {
        padding: 10px;
        margin-top: 1.5rem;
    }
    .graph-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }
    .graph-grid {
        display: grid;
        grid-auto-flow: column;
        grid-template-rows: repeat(7, 1fr);
        gap: 3px;
    }
    .graph-container.size-small .graph-grid {
        grid-template-rows: repeat(7, 10px);
        gap: 2px;
    }
    .month-labels {
        display: grid;
        grid-auto-flow: column;
        gap: 3px;
        margin-left: 25px;
        margin-bottom: 5px;
    }
    .graph-container.size-small .month-labels {
        margin-left: 0;
        gap: 2px;
    }
    .month-label {
        font-size: 12px;
        color: #586069;
        white-space: nowrap;
    }
    .graph-container.size-small .month-label {
        font-size: 10px;
    }
    .day-labels {
        display: grid;
        grid-template-rows: repeat(7, 1fr);
        gap: 3px;
        float: left;
        font-size: 12px;
        color: #586069;
        margin-right: 5px;
        padding-top: 21px;
    }
    .day-label {
        text-align: center;
    }
    .day {
        width: 16px;
        height: 16px;
        background-color: #ebedf0;
        border-radius: 3px;
        position: relative;
    }
    .graph-container.size-small .day {
        width: 10px;
        height: 10px;
    }
    .day.empty {
        background-color: transparent;
        border: 1px dashed #e1e4e8;
    }
    .day[data-level="1"] { background-color: #9be9a8; }
    .day[data-level="2"] { background-color: #40c463; }
    .day[data-level="3"] { background-color: #30a14e; }
    .day[data-level="4"] { background-color: #216e39; }
    .day .tooltip {
        visibility: hidden;
        width: max-content;
        background-color: #333;
        color: #fff;
        text-align: center;
        border-radius: 4px;
        padding: 5px 8px;
        position: absolute;
        z-index: 1;
        bottom: 125%;
        left: 50%;
        transform: translateX(-50%);
        opacity: 0;
        transition: opacity 0.2s;
        font-size: 12px;
    }
    .day:hover .tooltip {
        visibility: visible;
        opacity: 1;
    }
    .legend {
        display: flex;
        align-items: center;
        font-size: 12px;
        color: #586069;
    }
    .legend .box {
        width: 12px;
        height: 12px;
        border-radius: 2px;
        margin: 0 2px 0 8px;
    }
</style>

<div class="graph-container size-{{ size }}">
    {% if size == 'large' %}
    <div class="graph-header">
        <h5>올해의 Todo 완료 기록</h5>
        <div class="legend">
            Less
            <div class="box" style="background-color: #ebedf0;"></div>
            <div class="box" style="background-color: #9be9a8;"></div>
            <div class="box" style="background-color: #40c463;"></div>
            <div class="box" style="background-color: #30a14e;"></div>
            <div class="box" style="background-color: #216e39;"></div>
            More
        </div>
    </div>
    {% endif %}

    <div class="d-flex">
        {% if size == 'large' %}
        <div class="day-labels">
            <div class="day-label"></div>
            <div class="day-label">Mon</div>
            <div class="day-label"></div>
            <div class="day-label">Wed</div>
            <div class="day-label"></div>
            <div class="day-label">Fri</div>
            <div class="day-label"></div>
        </div>
        {% endif %}
        <div style="width: 100%;">
            <div class="month-labels" style="grid-template-columns: repeat({{ month_weeks|length }}, auto);">
                {% for month, span in month_weeks.items() %}
                    <div class="month-label" style="grid-column: span {{ span }};">{{ month }}</div>
                {% endfor %}
            </div>
            <div class="graph-grid" style="grid-template-columns: repeat({{ weeks|length }}, auto);">
                {% for week in weeks %}
                    {% for day in week %}
                        {% if day.date.year == today.year %}
                            <div class="day" data-level="{{ day.level }}">
                                {% if size == 'large' %}
                                <span class="tooltip">{{ day.count }} todos on {{ day.date.strftime('%Y-%m-%d') }}</span>
                                {% endif %}
                            </div>
                        {% else %}
                            <div class="day empty"></div>
                        {% endif %}
                    {% endfor %}
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endmacro %}
